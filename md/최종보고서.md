# ClinicalTrials.gov Outcomes 정규화 프로젝트 최종 보고서

## 1. 목표

### 1.1 프로젝트 목적

ClinicalTrials.gov에서 수집한 Alzheimer's Disease 관련 임상시험의 Primary/Secondary Outcome 데이터를 구조화된 형태로 정규화하여, 분석 및 검색이 가능한 형태로 변환하는 것이 목표입니다.

### 1.2 핵심 목표

- **Primary/Secondary outcome과 time frame을 한 세트로 정규화**
- **Outcome 정규화**: `measure_raw` → `measure_clean` → `measure_norm` (사전 기반)
- **Time frame 정규화**: `time_frame_raw` → `time_value_main` + `time_unit_main` (숫자 + 단위)
- **정확성 우선**: 애매한 데이터는 모두 실패 처리하여 정확성 확보

### 1.3 궁극적 목표

- Outcome dictionary 기반 정규화 (`measure_code`, `measure_norm`, `domain`)
- Time, unit으로 깔끔하게 숫자 + unit 형태로 분리
- 정규화된 데이터를 활용한 분석 및 검색 기능 제공

---

## 2. 전체 큰 그림

### 2.1 단계별 정규화 전략

본 프로젝트는 **단계별 정규화 전략**을 채택하여 점진적으로 데이터 품질을 향상시킵니다:

#### **1차 정규화: 엄격한 규칙 기반 파싱**

- **목적**: 명확하게 파싱 가능한 데이터만 정규화
- **방법**: 정규식 패턴 기반 파싱
- **성공 기준**:
  - Time frame 파싱 성공 (`time_value_main`, `time_unit_main` 추출)
  - Dictionary 매칭 성공 (`measure_code` 할당)
- **특징**:
  - 단일 시점 및 복수 시점 모두 지원
  - Baseline 포함 시 `change_from_baseline_flag` 설정
  - 애매한 케이스는 모두 실패 처리

#### **2차 정규화: 복수 시점 파싱 및 고도화**

- **목적**: 복수 시점(time points)을 포함한 time frame 파싱
- **방법**:
  - 복수 시점을 JSONB 배열로 저장 (`time_points`)
  - 마지막/가장 큰 값으로 `time_value_main` 설정
- **현재 상태**: 1차 정규화에 이미 포함됨

#### **3차 정규화: 룰 보완 및 패턴 확장**

- **목적**: 실패 케이스 분석을 통한 정규식 패턴 추가
- **방법**:
  - 기관/담당자별 실패 패턴 분석
  - 새로운 정규식 패턴 추가
  - 파싱 성공률 향상

#### **최후의 수단: LLM 기반 정규화**

- **목적**: 규칙 기반으로 파싱 불가능한 복잡한 케이스 처리
- **방법**:
  - LLM을 활용한 의미 기반 파싱
  - 규칙 기반 파싱 실패 케이스에 한정 적용
  - 검증 및 품질 관리 필수

### 2.2 데이터 흐름

```
원본 데이터 (ClinicalTrials.gov API)
    ↓
outcome_raw (원본 보존)
    ↓
1차 정규화 (normalize_phase1.py)
    ↓
outcome_normalized (정규화 결과)
    ↓
데이터 분리 (separate_normalized_data.py)
    ├─ outcome_normalized_success (성공 케이스)
    └─ outcome_normalized_failed (실패 케이스)
    ↓
2차 정규화 (Dictionary 기반)
    ↓
최종 정규화 데이터
```

### 2.3 성공 기준 (Study 단위)

**Study 단위 성공 기준:**

- **Primary outcome**: 하나라도 성공 (measure_code IS NOT NULL AND failure_reason IS NULL)
- **Secondary outcome**: 없거나, 하나라도 성공

**성공한 Study의 모든 outcome**은 `outcome_normalized_success` 테이블에 포함됩니다.

---

## 3. 정규식 내용

### 3.1 TimeFrame 파싱 패턴

#### 3.1.1 기본 원칙

- **단일 시점 및 복수 시점 모두 지원**
- 복수 시점은 `time_points` JSONB 배열로 저장
- Baseline 포함 시 `change_from_baseline_flag = TRUE` 설정
- 애매한 범위 표현은 실패 처리

**정규식 표기법 참고:**

- `\b`: 단어 경계(word boundary) - 단어가 독립적으로 나타날 때만 매칭
- `\s+`: 하나 이상의 공백 문자
- `\d+`: 하나 이상의 숫자
- `.*?`: 비탐욕적 매칭 (가장 짧은 매칭)

#### 3.1.2 파싱 가능한 패턴

**1. Baseline 포함**

- 패턴: `\bbaseline\b` (대소문자 무시)
  - `\b`는 단어 경계를 의미하므로 "baseline"이 독립적으로 나타날 때만 매칭
  - 예: "baseline" ✓, "baselines" ✗, "prebaseline" ✗
- 예: "Baseline, Week 16" → `change_from_baseline_flag = TRUE`, `time_points = [{"value": 16, "unit": "week"}]`

**2. At Day/Week/Month N**

- 패턴: `\bat\s+(day|days|week|weeks|month|months)\s+\d+`
- 예: "At Week 14" → 14, week

**3. Day/Month/Week N 단독**

- 패턴: `\b(day|days|month|months|week|weeks)\s+\d+`
- 예: "Day 1", "Month 3", "Week 12" → 1, day / 3, month / 12, week

**4. 숫자 + 단위 (하이픈 포함, hr/hrs 지원)**

- 패턴: `\d+\s*-?\s*(week|weeks|month|months|year|years|day|days|hour|hours|hr|hrs)`
- 예: "26 weeks", "96-week", "21-months", "48 hr" → 26, week / 96, week / 21, month / 48, hour

**5. Year N (소수점 지원)**

- 패턴: `year\s*\d+`
- 예: "Year 3.5" → 3.5, year (NUMERIC 타입으로 저장)

**6. 텍스트 숫자**

- 패턴: `(one|two|three|...|hundred)\s+(week|weeks|month|months|year|years|day|days|hour|hours)`
- 예: "Two years", "eight weeks" → 2, year / 8, week

**7. Up to N**

- 패턴: `up\s*to\s+\d+` 또는 `up\s*to\s+(day|days|week|weeks|month|months|year|years)\s+\d+`
- 예: "up to 72 hours" → 72, hour

**8. 복수 시점**

- 패턴: `(week|weeks|day|days|month|months)\s+\d+.*?,\s*(week|weeks|day|days|month|months)\s+\d+`
- 예: "At 12 and 24 weeks" → `time_value_main = 24`, `time_unit_main = "week"`, `time_points = [{"value": 12, "unit": "week"}, {"value": 24, "unit": "week"}]`
- 예: "baseline, 5, 30, 60, and 180 min" → `change_from_baseline_flag = TRUE`, `time_points = [{"value": 5, "unit": "min"}, {"value": 30, "unit": "min"}, {"value": 60, "unit": "min"}, {"value": 180, "unit": "min"}]`

**9. Day N to/through M**

- 패턴: `\bday\s+\d+\s+(to|through)\s+(day\s+)?\d+`
- 예: "Day 1 to Day 7" → 복수 시점으로 처리

**10. For N Months/Weeks/Days**

- 패턴: `\bfor\s+\d+\s+(month|months|week|weeks|day|days)`
- 예: "For 10 Months" → 10, month

**11. At Months N and M**

- 패턴: `\bat\s+months?\s+\d+\s+and\s+\d+`
- 예: "At Months 6 and 12" → 복수 시점으로 처리

#### 3.1.3 실패 처리 패턴

다음과 같은 패턴은 **실패 처리**됩니다:

- **복잡한 범위**: "Day 1 through 7", "3-5 years", "Day 15-19"
- **복잡한 조건**: "Will be worn for seven days during baseline and for seven days during weeks 9, 17, 25 and 37"
- **콜론 포함**: "Day 1: Pre-dose and 2, 4, 8..."
- **음수 시점**: "Week -4"
- **비표준 표현**: "% of exact responses", "The time to respond"

### 3.2 Measure 파싱 패턴

#### 3.2.1 텍스트 클리닝

- 연속 공백 → 단일 공백
- 오타 교정 (extention → extension 등)
- 앞뒤 공백 제거

#### 3.2.2 약어 추출

- 패턴: `\([A-Za-z][A-Za-z0-9\-+\s/]+\)`
- 예: "(TMT-A/B)", "(pharmacodynamics)", "(NPI)"
- 소문자, 슬래시(/), 하이픈(-) 포함 지원

### 3.3 Description 파싱 패턴

#### 3.3.1 Change from Baseline 감지

- 패턴: `change\s+(from|of)\s+baseline|difference\s+from\s+baseline`
- `change_from_baseline_flag = TRUE` 설정

---

## 4. 사전 내용

### 4.1 Dictionary 구조

`outcome_measure_dict` 테이블은 다음과 같은 구조를 가집니다:

- **measure_code**: Measure 코드 (PK, 예: "ADAS_COG", "MMSE")
- **canonical_name**: 표준 이름 (예: "Alzheimer's Disease Assessment Scale - Cognitive Subscale")
- **abbreviation**: 약어 (예: "ADAS-Cog")
- **domain**: 도메인 (예: "COGNITION", "FUNCTION", "BEHAVIOR", "BIOMARKER")
- **typical_role**: 일반적 역할 (예: "PRIMARY", "SECONDARY", "BOTH")
- **keywords**: 키워드 (세미콜론으로 구분, 예: "adas-cog;adas cog;adascog")

### 4.2 Dictionary 매칭 우선순위

Dictionary 매칭은 다음 우선순위로 수행됩니다:

1. **0순위 (최우선)**: `measure_code` 직접 매칭

   - `measure_clean`을 정규화하여 `measure_code`와 비교 (대소문자/공백/하이픈 무시)

2. **1순위**: `abbreviation` 매칭

   - 괄호에서 추출한 약어를 `abbreviation`과 비교 (대소문자/공백/하이픈 무시)

3. **2순위**: `keywords` 매칭

   - `keywords` 필드의 키워드와 `measure_clean`을 정규화하여 **완전 일치** 확인
   - 대소문자/공백/하이픈/언더스코어 무시하고 정규화 후 비교
   - **완전 일치만 허용**: 예를 들어 키워드 "ess"는 "ESS"와 매칭되지만 "goodness"와는 매칭되지 않음
   - 키워드는 세미콜론(`;`)으로 구분된 리스트

4. **3순위**: `canonical_name` 매칭
   - `measure_clean`을 정규화하여 `canonical_name`과 정확히 일치하는지 확인 (대소문자/공백/하이픈 무시)

### 4.3 Dictionary 현황

- **총 Dictionary 항목 수**: 123개
- **주요 도메인**:
  - COGNITION: 인지 평가 도구 (ADAS-Cog, MMSE, MoCA 등)
  - FUNCTION: 일상생활 기능 평가 (ADCS-ADL, FAQ 등)
  - BEHAVIOR: 행동/정신 평가 (NPI, CMAI 등)
  - BIOMARKER: 바이오마커 (CSF, PET 등)
  - SAFETY: 안전성 평가 (AE, SAE 등)
  - QOL: 삶의 질 평가 (QoL-AD, EQ-5D 등)

---

## 5. 결과 통계

### 5.1 전체 통계

| 구분              | 건수     | 비율  |
| ----------------- | -------- | ----- |
| **총 Studies**    | 3,866건  | 100%  |
| **총 Outcomes**   | 25,591건 | 100%  |
| **성공 Studies**  | 1,718건  | 44.4% |
| **성공 Outcomes** | 12,698건 | 49.6% |
| **실패 Outcomes** | 12,893건 | 50.4% |

**성공 기준**: Study 단위로 판단

- Primary outcome 중 하나라도 성공 (measure_code IS NOT NULL AND failure_reason IS NULL)
- Secondary outcome이 없거나, Secondary outcome 중 하나라도 성공

### 5.2 Outcome Type별 통계

#### Primary Outcomes

| 구분     | 건수    | 비율  |
| -------- | ------- | ----- |
| **성공** | 4,941건 | 52.0% |
| **실패** | 4,572건 | 48.0% |

#### Secondary Outcomes

| 구분     | 건수    | 비율  |
| -------- | ------- | ----- |
| **성공** | 7,757건 | 48.2% |
| **실패** | 8,321건 | 51.8% |

### 5.3 Dictionary 매칭 통계

| 구분                     | 건수     | 비율  |
| ------------------------ | -------- | ----- |
| **Dictionary 매칭 성공** | 12,867건 | 50.3% |
| **Dictionary 매칭 실패** | 12,724건 | 49.7% |

### 5.4 TimeFrame 파싱 통계

| 구분                    | 건수     | 비율  |
| ----------------------- | -------- | ----- |
| **TimeFrame 파싱 성공** | 22,296건 | 87.1% |
| **TimeFrame 파싱 실패** | 3,295건  | 12.9% |

### 5.5 기관/담당자 통계

#### LEAD_SPONSOR (기관)

| 구분            | 건수    |
| --------------- | ------- |
| **총 기관 수**  | 1,316개 |
| **총 Study 수** | 3,986건 |

#### OFFICIAL (담당자)

| 구분             | 건수    |
| ---------------- | ------- |
| **총 담당자 수** | 2,808명 |
| **총 Study 수**  | 3,025건 |

### 5.6 기관별 성공/실패 통계

#### 성공 데이터 기관별 분포 - Study 기준 (Top 10, 성공률 순)

| 순위 | 기관명                              | 클래스   | 성공 Studies | 전체 Studies | 성공률 |
| ---- | ----------------------------------- | -------- | ------------ | ------------ | ------ |
| 1    | Biogen                              | INDUSTRY | 12건         | 13건         | 92.31% |
| 2    | Hoffmann-La Roche                   | INDUSTRY | 21건         | 25건         | 84.00% |
| 3    | Genentech, Inc.                     | INDUSTRY | 10건         | 12건         | 83.33% |
| 4    | University of Michigan              | OTHER    | 8건          | 11건         | 72.73% |
| 5    | Columbia University                 | OTHER    | 12건         | 18건         | 66.67% |
| 6    | Eli Lilly and Company               | INDUSTRY | 32건         | 50건         | 64.00% |
| 7    | Emory University                    | OTHER    | 16건         | 25건         | 64.00% |
| 8    | Eisai Inc.                          | INDUSTRY | 14건         | 23건         | 60.87% |
| 9    | Janssen Research & Development, LLC | INDUSTRY | 11건         | 19건         | 57.89% |
| 10   | Merck Sharp & Dohme LLC             | INDUSTRY | 18건         | 32건         | 56.25% |

#### 성공 데이터 기관별 분포 - Outcome 기준 (Top 10, 성공률 순)

| 순위 | 기관명                                                      | 클래스   | 성공 Outcomes | 전체 Outcomes | 성공률 |
| ---- | ----------------------------------------------------------- | -------- | ------------- | ------------- | ------ |
| 1    | Hoffmann-La Roche                                           | INDUSTRY | 289건         | 317건         | 91.17% |
| 2    | Biogen                                                      | INDUSTRY | 95건          | 106건         | 89.62% |
| 3    | Otsuka Pharmaceutical Development & Commercialization, Inc. | INDUSTRY | 109건         | 124건         | 87.90% |
| 4    | Merck Sharp & Dohme LLC                                     | INDUSTRY | 165건         | 207건         | 79.71% |
| 5    | Eli Lilly and Company                                       | INDUSTRY | 353건         | 484건         | 72.93% |
| 6    | Pfizer                                                      | INDUSTRY | 434건         | 640건         | 67.81% |
| 7    | Icahn School of Medicine at Mount Sinai                     | OTHER    | 69건          | 102건         | 67.65% |
| 8    | NYU Langone Health                                          | OTHER    | 126건         | 187건         | 67.38% |
| 9    | Janssen Research & Development, LLC                         | INDUSTRY | 96건          | 144건         | 66.67% |
| 10   | Cerecin                                                     | INDUSTRY | 67건          | 103건         | 65.05% |

#### 실패 데이터 기관별 분포 - Study 기준 (Top 10, 실패률 순)

| 순위 | 기관명                                                           | 클래스   | 실패 Studies | 전체 Studies | 실패률 |
| ---- | ---------------------------------------------------------------- | -------- | ------------ | ------------ | ------ |
| 1    | Johnson & Johnson Pharmaceutical Research & Development, L.L.C.  | INDUSTRY | 15건         | 15건         | 100%   |
| 2    | GE Healthcare                                                    | INDUSTRY | 10건         | 10건         | 100%   |
| 3    | Seoul National University Hospital                               | OTHER    | 9건          | 11건         | 81.82% |
| 4    | AstraZeneca                                                      | INDUSTRY | 21건         | 26건         | 80.77% |
| 5    | Novartis                                                         | INDUSTRY | 12건         | 15건         | 80.00% |
| 6    | Avid Radiopharmaceuticals                                        | INDUSTRY | 32건         | 42건         | 76.19% |
| 7    | Wyeth is now a wholly owned subsidiary of Pfizer                 | INDUSTRY | 24건         | 32건         | 75.00% |
| 8    | University Hospital, Lille                                       | OTHER    | 9건          | 12건         | 75.00% |
| 9    | Barcelonabeta Brain Research Center, Pasqual Maragall Foundation | OTHER    | 10건         | 14건         | 71.43% |
| 10   | University Hospital, Bordeaux                                    | OTHER    | 12건         | 17건         | 70.59% |

#### 실패 데이터 기관별 분포 - Outcome 기준 (Top 10, 실패률 순)

| 순위 | 기관명                                    | 클래스   | 실패 Outcomes | 전체 Outcomes | 실패률 |
| ---- | ----------------------------------------- | -------- | ------------- | ------------- | ------ |
| 1    | Novoic Limited                            | INDUSTRY | 140건         | 140건         | 100%   |
| 2    | CanSino Biologics Inc.                    | INDUSTRY | 90건          | 100건         | 90.00% |
| 3    | National Institute on Aging (NIA)         | NIH      | 120건         | 141건         | 85.11% |
| 4    | AstraZeneca                               | INDUSTRY | 114건         | 143건         | 79.72% |
| 5    | University of North Carolina, Chapel Hill | OTHER    | 81건          | 102건         | 79.41% |
| 6    | University of Pittsburgh                  | OTHER    | 89건          | 129건         | 68.99% |
| 7    | University Hospital, Toulouse             | OTHER    | 90건          | 135건         | 66.67% |
| 8    | Avid Radiopharmaceuticals                 | INDUSTRY | 84건          | 126건         | 66.67% |
| 9    | University of California, Los Angeles     | OTHER    | 110건         | 170건         | 64.71% |
| 10   | University Hospital, Bordeaux             | OTHER    | 133건         | 208건         | 63.94% |

### 5.7 담당자별 성공/실패 통계

#### 성공 데이터 담당자별 분포 - Study 기준 (Top 10, 성공률 순)

| 순위 | 담당자명                               | 소속                                          | 성공 Studies | 전체 Studies | 성공률 |
| ---- | -------------------------------------- | --------------------------------------------- | ------------ | ------------ | ------ |
| 1    | Call 1-877-CTLILLY (1-877-285-4559)... | Eli Lilly and Company                         | 7건          | 7건          | 100%   |
| 2    | Medical Director                       | Biogen                                        | 12건         | 13건         | 92.31% |
| 3    | Clinical Trials                        | Hoffmann-La Roche                             | 26건         | 30건         | 86.67% |
| 4    | Ying Han, PhD                          | Xuanwu Hospital of Capital Medical University | 4건          | 5건          | 80.00% |
| 5    | Bruno Kajiyama, MS                     | Photozig, Inc.                                | 4건          | 5건          | 80.00% |
| 6    | Laura Gault, MD                        | AbbVie                                        | 4건          | 5건          | 80.00% |
| 7    | Medical Director                       | Merck Sharp & Dohme LLC                       | 14건         | 19건         | 73.68% |
| 8    | Tammie Benzinger, MD, PhD              | Washington University School of Medicine      | 7건          | 10건         | 70.00% |
| 9    | ABBVIE INC.                            | AbbVie                                        | 4건          | 6건          | 66.67% |
| 10   | Call 1-877-CTLILLY (1-877-285-4559)... | Eli Lilly and Company                         | 20건         | 35건         | 57.14% |

#### 성공 데이터 담당자별 분포 - Outcome 기준 (Top 10, 성공률 순)

| 순위 | 담당자명                               | 소속                                     | 성공 Outcomes | 전체 Outcomes | 성공률 |
| ---- | -------------------------------------- | ---------------------------------------- | ------------- | ------------- | ------ |
| 1    | Nand Singh, MD                         | Quotient Sciences...                     | 72건          | 72건          | 100%   |
| 2    | TrueBinding, Inc.                      | TrueBinding, Inc.                        | 66건          | 66건          | 100%   |
| 3    | Call 1-877-CTLILLY (1-877-285-4559)... | Eli Lilly and Company                    | 60건          | 60건          | 100%   |
| 4    | Tsuo-Hung Lan, MD, PhD.                | National Yang Ming Chiao Tung University | 56건          | 56건          | 100%   |
| 5    | Medical Director Clinical Science      | Takeda                                   | 83건          | 85건          | 97.65% |
| 6    | Clinical Trials                        | Hoffmann-La Roche                        | 348건         | 376건         | 92.55% |
| 7    | Medical Director                       | Biogen                                   | 95건          | 106건         | 89.62% |
| 8    | Medical Director                       | Merck Sharp & Dohme LLC                  | 150건         | 174건         | 86.21% |
| 9    | Mariana Figueiro, PhD                  | Icahn School of Medicine at Mount Sinai  | 54건          | 68건          | 79.41% |
| 10   | Pfizer CT.gov Call Center              | Pfizer                                   | 448건         | 646건         | 69.35% |

#### 실패 데이터 담당자별 분포 - Study 기준 (Top 10, 실패률 순)

| 순위 | 담당자명                                                                        | 소속                                                            | 실패 Studies | 전체 Studies | 실패률 |
| ---- | ------------------------------------------------------------------------------- | --------------------------------------------------------------- | ------------ | ------------ | ------ |
| 1    | Johnson & Johnson Pharmaceutical Research & Development, L.L. C. Clinical Trial | Johnson & Johnson Pharmaceutical Research & Development, L.L.C. | 12건         | 12건         | 100%   |
| 2    | Chief Medical Officer                                                           | Avid Radiopharmaceuticals, Inc.                                 | 8건          | 9건          | 88.89% |
| 3    | Danna L Jennings, MD                                                            | Institute for Neurodegenerative Disorders                       | 6건          | 7건          | 85.71% |
| 4    | Chief Medical Officer                                                           | Avid Radiopharmaceuticals                                       | 18건         | 22건         | 81.82% |
| 5    | Bayer Study Director                                                            | Bayer                                                           | 4건          | 5건          | 80.00% |
| 6    | Novartis Pharmaceuticals                                                        | Novartis Pharmaceuticals                                        | 15건         | 20건         | 75.00% |
| 7    | Medical Monitor                                                                 | Wyeth is now a wholly owned subsidiary of Pfizer                | 20건         | 27건         | 74.07% |
| 8    | Randall J Bateman, MD                                                           | Washington University School of Medicine                        | 4건          | 6건          | 66.67% |
| 9    | Paul Aisen, MD                                                                  | USC Alzheimer's Therapeutic Research Institute (ATRI)           | 4건          | 6건          | 66.67% |
| 10   | Jeffrey Burns, MD                                                               | University of Kansas Medical Center                             | 3건          | 5건          | 60.00% |

#### 실패 데이터 담당자별 분포 - Outcome 기준 (Top 10, 실패률 순)

| 순위 | 담당자명                          | 소속                                      | 실패 Outcomes | 전체 Outcomes | 실패률 |
| ---- | --------------------------------- | ----------------------------------------- | ------------- | ------------- | ------ |
| 1    | Nand Singh, BSc, MD, DPM, MFPM    | Quotient Sciences...                      | 94건          | 94건          | 100%   |
| 2    | Emil Fristed, MSc                 | Novoic Ltd                                | 65건          | 65건          | 100%   |
| 3    | Jonathan Evans, MD                | Nottingham University Hospitals NHS Trust | 57건          | 57건          | 100%   |
| 4    | Patrice F Jones, CPC              | California Institute of Integral Studies  | 56건          | 56건          | 100%   |
| 5    | Anne Huffman, PhD                 | California Institute of Integral Studies  | 56건          | 56건          | 100%   |
| 6    | Dimitrios I Kapogiannis, M.D.     | National Institute on Aging (NIA)         | 94건          | 104건         | 90.38% |
| 7    | Ana-Maria Vranceanu, PhD          | Massachusetts General Hospital            | 47건          | 52건          | 90.38% |
| 8    | Randall J Bateman, MD             | Washington University School of Medicine  | 61건          | 72건          | 84.72% |
| 9    | Novartis Pharmaceuticals          | Novartis Pharmaceuticals                  | 104건         | 129건         | 80.62% |
| 10   | Email contact via H. Lundbeck A/S | LundbeckClinicalTrials@lundbeck.com       | 47건          | 64건          | 73.44% |

### 5.8 실패 원인별 통계

실패 원인은 `failure_reason` 필드로 구분됩니다:

| 실패 원인               | 건수     | 비율  |
| ----------------------- | -------- | ----- |
| **SUCCESS**             | 11,451건 | 44.7% |
| **MEASURE_CODE_FAILED** | 10,845건 | 42.4% |
| **BOTH_FAILED**         | 1,879건  | 7.3%  |
| **TIMEFRAME_FAILED**    | 1,416건  | 5.5%  |

**참고**: 성공 기준은 Time frame 파싱 성공(`time_value_main`, `time_unit_main` 추출) AND Dictionary 매칭 성공(`measure_code` 할당)입니다.

### 5.9 Change from Baseline 통계

| 구분                          | 건수    | 비율  |
| ----------------------------- | ------- | ----- |
| **Change from Baseline 설정** | 9,469건 | 37.0% |

### 5.10 실패 케이스 예시

#### 실패한 Measure 패턴 (빈도수 높은 Top 10)

| 순위 | Measure                                   | 빈도수 | Study 수 | 예시 원본 텍스트                          |
| ---- | ----------------------------------------- | ------ | -------- | ----------------------------------------- |
| 1    | Preliminary efficacy data (screening)     | 12건   | 1건      | Preliminary efficacy data (screening)     |
| 2    | Change From Baseline in Cognitive Measure | 12건   | 1건      | Change From Baseline in Cognitive Measure |
| 3    | Cognitive function                        | 12건   | 7건      | Cognitive function                        |
| 4    | Depression                                | 9건    | 9건      | Depression                                |
| 5    | Perceived Stress Scale                    | 8건    | 5건      | Perceived Stress Scale                    |
| 6    | Change in cognition                       | 8건    | 5건      | Change in cognition                       |
| 7    | Caregiver Burden                          | 8건    | 8건      | Caregiver Burden                          |
| 8    | Acceptability                             | 8건    | 8건      | Acceptability                             |
| 9    | Cognition                                 | 8건    | 8건      | Cognition                                 |
| 10   | Efficacy                                  | 8건    | 3건      | Efficacy                                  |

**실패 원인**: Dictionary에 해당 measure가 없거나, 키워드/약어 매칭 실패

#### 실패한 TimeFrame 패턴 (빈도수 높은 Top 10)

| 순위 | TimeFrame (원본)                                                                | 빈도수 | Study 수 |
| ---- | ------------------------------------------------------------------------------- | ------ | -------- |
| 1    | Baseline                                                                        | 376건  | 83건     |
| 2    | baseline                                                                        | 119건  | 32건     |
| 3    | At inclusion                                                                    | 34건   | 4건      |
| 4    | Baseline, Immediately following treatment, Follow-up at 3-months post-treatment | 29건   | 1건      |
| 5    | Between baseline and -6th month                                                 | 28건   | 1건      |
| 6    | Baseline point (all groups)                                                     | 27건   | 1건      |
| 7    | 0, 1st, 3rd month (plus 4th and 6th month for controls AD_WaitC & AD_ActC)      | 24건   | 1건      |
| 8    | at inclusion                                                                    | 24건   | 6건      |
| 9    | Change in assessment scores from baseline to 6-months, 12-months, and 18-months | 22건   | 1건      |
| 10   | at enrollment                                                                   | 21건   | 1건      |

**실패 원인**:

- 단순히 "Baseline"만 있는 경우 (시간 값 없음)
- 복잡한 복수 시점 표현
- 비표준 표현 ("At inclusion", "at enrollment" 등)

---

## 6. 주요 성과

### 6.1 데이터 품질

- **정규화 성공률**: 49.6% (12,698건 / 25,591건)
- **Study 단위 성공률**: 44.4% (1,718건 / 3,866건)
- **Dictionary 매칭 성공률**: 50.3% (12,867건 / 25,591건)
- **TimeFrame 파싱 성공률**: 87.1% (22,296건 / 25,591건)
- **원본 데이터 보존**: 재처리 및 규칙 개선 가능
- **단계별 분리**: 성공/실패 데이터 명확히 구분

### 6.2 기술적 성과

- **엄격한 파싱 룰**: 단일 시점 및 복수 시점 모두 지원
- **패턴 기반 분석**: 정규식 패턴으로 체계적 파싱
- **Dictionary 기반 매칭**: 우선순위 기반 매칭으로 정확성 향상
- **확장 가능한 구조**: 2차 정규화를 위한 사전 구조 준비

### 6.3 향후 계획

1. **정규식 개선**: 실패 케이스 분석 후 패턴 추가
2. **Dictionary 확장**: 매칭 실패 케이스 기반 Dictionary 항목 추가
3. **3차 정규화**: 룰 보완 및 패턴 확장

### 6.4 최후 계획

4. **LLM 기반 정규화**: 규칙 기반으로 파싱 불가능한 복잡한 케이스 처리

---

## 7. 파일 구조

### 7.1 주요 스크립트

- `collect_outcomes.py`: 데이터 수집
- `normalize_phase1.py`: 1차 정규화
- `separate_normalized_data.py`: 데이터 분리 (성공/실패)
- `diagnose_all.py`: 데이터 진단 및 분석
- `normalization_patterns.py`: 정규식 패턴 정의
- `add_new_dictionary_items.py`: Dictionary 항목 추가

### 7.2 데이터베이스

- `schema.sql`: 테이블 스키마 정의
- `query_normalized_results.sql`: 정규화 결과 조회 쿼리
- `query_dictionary_statistics.sql`: Dictionary 통계 쿼리

---

## 8. 결론

1차 정규화는 **Time frame 파싱 성공**을 기준으로 하며, **Study 단위로 성공 여부를 판단**합니다.

**현황 분석**:

- Time frame 파싱 성공률: 87.1% (22,296건)
- Dictionary 매칭 성공률: 50.3% (12,867건)
- **최종 정규화 성공률**: 49.6% (12,698건 / 25,591건)
- **Study 단위 성공률**: 44.4% (1,718건 / 3,866건)

**핵심 성과**:

- 원본 데이터 완전 보존
- 엄격한 파싱 룰로 정확성 확보
- 단계별 정규화 구조 구축
- 패턴 기반 분석 체계 구축
- Dictionary 기반 매칭으로 정확성 향상

**다음 단계**:

- 실패 케이스 심층 분석 (기관/담당자별)
- 정규식 패턴 추가 및 개선
- Dictionary 확장 (매칭 실패 케이스 기반)
- 3차 정규화 (룰 보완)
- LLM 기반 정규화 (최후의 수단)
